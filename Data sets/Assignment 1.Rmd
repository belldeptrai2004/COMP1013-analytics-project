---
title: "COMP1013 Analytics Programming Project"
author: "Phạm Minh Khôi – 22145599"
date: "`r format(Sys.Date(), '%d %B %Y')`"
output: 
  pdf_document:
    number_sections: true
fontsize: 12pt
geometry: margin=1in
---
```{r}
# Load necessary packages
library(dplyr)
library(readr)
library(ggplot2)


# Load the CSV files
engines <- read_csv("Engine.csv")
automobile <- read_csv("Automobile.csv")
maintenance <- read_csv("Maintenance.csv")

# Check if data is loaded
head(engines)
head(automobile)
head(maintenance)
```
```{r}
# Q1 — Count how many rows contain "?" (per table + total)

# Robust helper: returns 0 if no character columns; never returns NA
rows_with_q <- function(df) {
  char_df <- dplyr::select(df, where(is.character))
  if (ncol(char_df) == 0) return(0L)
  has_q <- apply(char_df, 1, function(row) any(row == "?", na.rm = TRUE))
  sum(has_q)
}

affected_engines_rows     <- rows_with_q(engines)
affected_automobile_rows  <- rows_with_q(automobile)
affected_maintenance_rows <- rows_with_q(maintenance)
affected_total_rows       <- affected_engines_rows +
                              affected_automobile_rows +
                              affected_maintenance_rows

affected_engines_rows
affected_automobile_rows
affected_maintenance_rows
affected_total_rows
```
```{r}
# Replace "?" with NA in character columns
replace_q_to_na <- function(df){
  df %>%
    mutate(across(where(is.character), ~na_if(., "?")))
}

engines_na     <- replace_q_to_na(engines)
automobile_na  <- replace_q_to_na(automobile)
maintenance_na <- replace_q_to_na(maintenance)

# Check if replacement worked
summary(engines_na)
summary(automobile_na)
summary(maintenance_na)
```
```{r}
# Q1 — Post-replacement verification

# 1) Prove there is no "?" left in any character column
count_q_after <- function(df) {
  ch <- dplyr::select(df, where(is.character))
  if (ncol(ch) == 0) return(0L)
  # sum "?" over all character columns
  sum(apply(ch, 2, function(col) sum(col == "?", na.rm = TRUE)))
}

q_after_eng   <- count_q_after(engines_na)
q_after_auto  <- count_q_after(automobile_na)
q_after_maint <- count_q_after(maintenance_na)
q_after_total <- q_after_eng + q_after_auto + q_after_maint

q_after_eng; q_after_auto; q_after_maint; q_after_total  # expect all 0

# 2) Show NA counts per column (to document impact of replacement)
na_count_per_col <- function(df) sapply(df, function(x) sum(is.na(x)))

na_engines     <- na_count_per_col(engines_na)
na_automobile  <- na_count_per_col(automobile_na)
na_maintenance <- na_count_per_col(maintenance_na)

na_engines
na_automobile
na_maintenance
```